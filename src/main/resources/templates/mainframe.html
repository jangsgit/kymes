<!DOCTYPE html>
<html lang="ko" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1">
<!--    <link rel="icon" type="image/png" href="/images/logo/actas_log_a.png">-->
    <title text="ê²½ë•ì‚°ì—… MES"></title>
    <link rel="stylesheet" href="/resource/windowContainer/css/jquery.scrollbar.min.css">
    <link rel="stylesheet" href="/resource/windowContainer/css/bootstrap.min.css">
    <link rel="stylesheet" href="/resource/windowContainer/css/nth-icons.css">
    <link rel="stylesheet" href="/resource/windowContainer/css/nth-tabs.css">
    <link rel="stylesheet" href="/resource/ax5ui/ax5ui.all.css">
    <link rel="stylesheet" href="/css/animate.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/theme-top-mes.css">
    <!--    <link rel="stylesheet" href="/css/theme-left-mes.css">-->
    <link rel="stylesheet" type="text/css" href="/css/import.css">
    <script src="/js/vendor/jquery-3.6.0.js"></script>
    <script src="/js/vendor/jquery-ui.min.js"></script>
    <script src="/js/ui.js"></script> <!-- Common js -->
    <script src="/js/utilscript.js"></script> <!-- ë°•ê´‘ì—´ -->


    <style>
        .left {
            cursor: pointer;
        }

        .menu_area {
            transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out;
            transform: translateX(0); /* ê¸°ë³¸ ìœ„ì¹˜ */
            opacity: 1;
            width: 250px; /* ë©”ë‰´ ë„ˆë¹„ */
            position: absolute; /* ì™¼ìª½ ê³ ì • */
            left: 0;
            visibility: visible;
            pointer-events: auto;
        }

        /* ë©”ë‰´ê°€ ì‚¬ë¼ì§ˆ ë•Œ */
        .menu_area.hidden {
            transform: translateX(-250px); /* ë¶€ë“œëŸ½ê²Œ ì™¼ìª½ìœ¼ë¡œ ì‚¬ë¼ì§ */
            opacity: 0;
            visibility: hidden;
            pointer-events: none; /* í´ë¦­ ë°©ì§€ */
        }

        /* ì»¨í…ì¸  ì˜ì—­ */
        .con_area {
            transition: width 0.3s ease-in-out, left 0.3s ease-in-out;
            width: calc(100% - 250px); /* ê¸°ë³¸ì ìœ¼ë¡œ ë©”ë‰´ ë„ˆë¹„ë§Œí¼ ì¤„ì–´ë“  ìƒíƒœ */
            left: 250px; /* ë©”ë‰´ê°€ ìˆì„ ë•Œ ê¸°ë³¸ ìœ„ì¹˜ */
        }

        /* ë©”ë‰´ê°€ ì‚¬ë¼ì§€ë©´ ì»¨í…ì¸  ì˜ì—­ í™•ì¥ */
        .menu_area.hidden + .con_area {
            width: 100%;
            left: 0;
        }

        /* ë¶€ë“œëŸ½ê²Œ ë‚˜ì˜¤ëŠ” ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes menuFadeIn {
            0% {
                transform: translateX(-250px);
                opacity: 0;
            }
            100% {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .header-info {
            display: grid;
            grid-template-columns: 1fr auto; /* ì™¼ìª½ì€ ê°€ë³€, ì˜¤ë¥¸ìª½ì€ ê³ ì • */
            align-items: center;
            width: 100%;
            gap: 10px;
        }


        /* ì™¼ìª½ ì˜ì—­ */
        .header-left {
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 0; /* âœ… grid ì…€ì—ì„œ ì¤„ì–´ë“¤ë„ë¡ */
        }

        /* ì˜¤ë¥¸ìª½ ì˜ì—­ */
        .header-right {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-menu {
            display: flex;
            flex-wrap: nowrap;
            gap: 8px;
            overflow-x: auto;
            overflow-y: hidden;
            white-space: nowrap;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .header-menu::-webkit-scrollbar {
            display: none; /* âœ… Chrome, Safari */
        }

        /* help ë²„íŠ¼ */
        a.help {
            background-color: #0056b3;
            color: #fff;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 13px;
            text-decoration: none;
            transition: 0.2s;
        }

        a.help:hover {
            background-color: #0066cc;
        }

        .header-menu .menu-btn {
            user-select: none;
        }

        .header-menu .menu-btn.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }




    </style>
</head>

<body>
<div class="page-wrapper sub-page">
    <div class="dashboard-layout-header">
        <header>
            <div class="left" style="justify-content: center;">
                <div class="logo">
<!--                    <img src="/images/logo/actas_log.png" alt="ë¡œê³ ">-->
                    <h1>(ì£¼)ê²½ë•ì‚°ì—… MES</h1>
                </div>
            </div>
            <div class="right">
                <div id="navbarBarMenu2" style="margin-left: 10px;">
                    <div class="open_menu">
                        <span class="bar"></span>
                        <span class="bar"></span>
                        <span class="bar"></span>
                    </div>
                </div>
                <div class="header-info">
                    <div class="header-left">
                        <div class="weather">
                            <div class="wt-main">
                                <p id="area"></p>
                                <div class="wt-graphic">
                                    <img id="weatherIcon" src="" alt="">
                                    <!--                            <p id="temperature"></p> &lt;!&ndash; ê¸°ì¡´ì˜ <span> íƒœê·¸ë¥¼ ì œê±° -->
                                    <p id="temperature"></p>
                                </div>
                                <!--<p id="lastUpdated" style="font-size: 12px; color: gray;"></p>-->
                                <p id="lastUpdated" style="display: none;"></p>
                            </div>
                            <div class="wt-detail">
                                <ul>
                                    <li>
                                        <img src="/images/icon/ico-umbrella.svg" alt="ê°•ìˆ˜">
                                        <p id="precipitationProbability"></p>
                                    </li>
                                    <li>
                                        <img src="/images/icon/ico-water.svg" alt="ìŠµë„">
                                        <p id="humidity"></p>
                                    </li>
                                    <li>
                                        <img src="/images/icon/ico-wind.svg" alt="í’ì†">
                                        <p id="windSpeed"></p>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!-- ì•ŒëŒ -->
    <!--                    <a href="#" class="alarm" title="ì•ŒëŒ">-->
    <!--                        <img src="/images/icon/ico-bell.svg" alt="ì•ŒëŒ ì•„ì´ì½˜">-->
    <!--                        <span>ì•ŒëŒ</span>-->
    <!--                        <span class="num">0</span>-->
    <!--                    </a>-->
    <!--                    <div class="alarm-box" style="width: 1000px;">-->
    <!--                        <ul class="alarm-tab-links">-->
    <!--                            <li class="active">-->
    <!--                                <a href="#alarm-tab1" title="ì£¼ë¬¸ì˜ë¢°">ì£¼ë¬¸ì˜ë¢°(0)</a> &lt;!&ndash; ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸ &ndash;&gt;-->
    <!--                            </li>-->
    <!--                        </ul>-->
    <!--                        <div class="alarm-tab-contents">-->
    <!--                            <div class="alarm-tab-item" id="alarm-tab1">-->
    <!--                                <div class="table-wrap">-->
    <!--                                    <table>-->
    <!--                                        <caption>ì•ŒëŒ í…Œì´ë¸”</caption>-->
    <!--                                        <colgroup>-->
    <!--                                            <col class="wp30"> &lt;!&ndash; ë‚ ì§œ &ndash;&gt;-->
    <!--                                            <col class="wp45"> &lt;!&ndash; ì—…ì²´ ì´ë¦„ &ndash;&gt;-->
    <!--                                            <col class="wp25"> &lt;!&ndash; ì£¼ë¬¸ ìƒíƒœ &ndash;&gt;-->
    <!--                                        </colgroup>-->
    <!--                                        <thead>-->
    <!--                                        <tr>-->
    <!--                                            <th>ë‚  ì§œ</th>-->
    <!--                                            <th>ì—…ì²´ ì´ë¦„</th>-->
    <!--                                            <th>ì£¼ë¬¸ ìƒíƒœ</th>-->
    <!--                                        </tr>-->
    <!--                                        </thead>-->
    <!--                                        <tbody>-->
    <!--                                        &lt;!&ndash; ì•Œë¦¼ ë°ì´í„°ê°€ ì—¬ê¸° ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ &ndash;&gt;-->
    <!--                                        </tbody>-->
    <!--                                    </table>-->
    <!--                                </div>-->
    <!--                            </div>-->
    <!--                            <a href="#" title="í™•ì¸" class="btn-gray" id="AlarmOk" onclick="AlarmOk()">í™•ì¸</a>-->
    <!--                        </div>-->
    <!--                    </div>-->
                        <!-- ì•ŒëŒ -->
                        <!-- ì‚¬ìš©ì ë¡œê·¸ì¸ ìƒíƒœ-->
                        <div class="header-menu">

                        </div>
                    </div>
                    <div class="header-right">
                        <a class="user" title="ì‚¬ìš©ì">
<!--                            <span style="padding:0 5px">Â·</span>-->
<!--                            <span style="padding:0 5px">Â·</span>-->
                            <span>ê´€ë¦¬ì</span>
                            <span style="padding-right: 8px">ë‹˜</span>
                        </a>
                        <div class="user-box">
                            <ul>
<!--                                <li>-->
<!--                                    <a id="myinfo" href="#" title="ë‚´ ì •ë³´" data-popup="popup1">ë‚´ ì •ë³´</a>-->
<!--                                </li>-->
                                <li id="logout">
                                    <a href="#" title="ë¡œê·¸ì•„ì›ƒ">ë¡œê·¸ì•„ì›ƒ</a>
                                </li>
                            </ul>
                        </div>
                        <a class="help" title="ì›ê²©ì ‘ì†" href="https://939.co.kr/dssystem" target="_blank" rel="noopener noreferrer">
                            ì›ê²©ì ‘ì†
                        </a>
                    </div>
                </div>
            </div>
        </header>
        <!--header [E]-->
    </div>

    <div class="menu_area">
        <div class="dashboard-layout-contents">

            <!-- [ëŒ€ì‹œë³´ë“œ] ì™¼ìª½ ì»¨í…ì¸  ì˜ì—­ -->
            <div class="dashboard-layout-left menu_wrap">
                <!-- (ë ˆì´ì•„ì›ƒ) ì‚¬ì´ë“œë°”  -->
                <div class="dashboard-layout-sidebar tabs" data-tab="tabWrap">
                    <ul class="layout-sidebar-tab">
                        <li class="active">
                            <a href="#menu" title="ì „ì²´ë©”ë‰´">ì „ì²´ ë©”ë‰´</a>
                        </li>
                        <li>
                            <a href="#bookmark" title="ë‚´ë©”ë‰´">ë‚´ ë©”ë‰´</a>
                        </li>
                    </ul>
                    <div class="layout-sidebar-tabcont">
<!--                        <div style="margin-top: 10px" id="searchkeyword-box">-->
<!--                            <input type="text" style="width: 90%" id="searchkeyword" name="searchkeyword" />-->
<!--                        </div>-->
                        <nav class="layout-nav sidebar-tabcont" id="menu">
                            <ul class="dep1">
                                <li class="dep1-1">
                                    <a href="#a" title="ê¸°ì¤€ì •ë³´" class="ico-lnb01">
                                        ê¸°ì¤€ì •ë³´
                                    </a>
                                    <ul class="dep2" id="dep2-monitoring">

                                    </ul>
                                </li>
                                <li class="dep1-1">
                                    <a href="#a" title="ê¸ˆí˜• ê´€ë¦¬" class="ico-lnb05">
                                        ê¸ˆí˜•ê´€ë¦¬
                                    </a>
                                    <ul class="dep2" id="dep2-information">

                                    </ul>
                                </li>
                                <li class="dep1-1">
                                    <a href="#a" title="ìƒì‚° ê´€ë¦¬" class="ico-lnb02">
                                        ìƒì‚° ê´€ë¦¬
                                    </a>
                                    <ul class="dep2" id="dep2-sales-management">

                                    </ul>
                                </li>
                                <li class="dep1-1">
                                    <a href="#a" title="ê³µì • ê´€ë¦¬" class="ico-lnb03">
                                        ê³µì • ê´€ë¦¬
                                    </a>
                                    <ul class="dep2" id="dep2-purchase-materials">

                                    </ul>
                                </li>
                                <li class="dep1-1">
                                    <a href="#a" title="ë‚©í’ˆ ê´€ë¦¬" class="ico-lnb03">
                                        ë‚©í’ˆ ê´€ë¦¬
                                    </a>
                                    <ul class="dep2" id="dep2-inventory-materials">

                                    </ul>
                                </li>
                                <li class="dep1-1">
                                    <a href="#a" title="F/PROOF" class="ico-lnb03">
                                        F/PROOF
                                    </a>
                                    <ul class="dep2" id="dep2-production-management">

                                    </ul>
                                </li>
                                <li class="dep1-1">
                                    <a href="#a" title="í’ˆì§ˆ ê´€ë¦¬" class="ico-lnb04">
                                        í’ˆì§ˆ ê´€ë¦¬
                                    </a>
                                    <ul class="dep2" id="dep2-quality">

                                    </ul>
                                </li>
<!--                                <li class="dep1-1">-->
<!--                                    <a href="#a" title="ë³´ê³ ì„œ ê´€ë¦¬" class="ico-lnb04">-->
<!--                                        ë³´ê³ ì„œ ê´€ë¦¬-->
<!--                                    </a>-->
<!--                                    <ul class="dep2" id="dep2-report">-->

<!--                                    </ul>-->
<!--                                </li>-->
                                <li class="dep1-1">
                                    <a href="#a" title="ì„¤ë¹„ê´€ë¦¬" class="ico-lnb04">
                                        ì„¤ë¹„ ê´€ë¦¬
                                    </a>
                                    <ul class="dep2" id="dep2-transaction">

                                    </ul>
                                </li>
<!--                                <li class="dep1-1">-->
<!--                                    <a href="#a" title="ê·¼íƒœê´€ë¦¬" class="ico-lnb04">-->
<!--                                        ê·¼íƒœ ê´€ë¦¬-->
<!--                                    </a>-->
<!--                                    <ul class="dep2" id="dep2-clock-inout">-->

<!--                                    </ul>-->
<!--                                </li>-->
                                <li class="dep1-1">
                                    <a href="#a" title="ì‹œìŠ¤í…œì„¤ì •" class="ico-lnb05">
                                        ì‹œìŠ¤í…œ ì„¤ì •
                                    </a>
                                    <ul class="dep2" id="dep2-system-settings">

                                    </ul>
                                </li>
                            </ul>

                        </nav> <!-- // nav end -->
                        <div class="layout-bookmark sidebar-tabcont" id="bookmark">
                            <ul class="bookmark-list" id="bookmark-menu">

                            </ul>
                        </div>
                    </div>
                    <div class="layout-sidebar-bottom">
                        <!--   <img src="/images/logo/logo-kt.svg" alt="kt logo">-->
                    </div>
                </div>
            </div><!-- //dashboard-layout-left end-->

            <!-- [ëŒ€ì‹œë³´ë“œ] ì˜¤ë¥¸ìª½ ì»¨í…ì¸  ì˜ì—­ -->
            <!-- //dashboard-layout-right end-->
        </div>
    </div>
    <div class="con_area">
        <!--      <div class="contents">-->
        <div class="nth-tabs" id="main-tabs"></div>
        <!--      </div>-->
    </div>

    <div class="footer">
        <!--footer [S]-->
        <span class="footer-left" id="link_privatepolicy" data-commonCd="ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨">ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</span>
        <span class="footer-left" id="link_emailreject" data-commonCd="ì´ë©”ì¼ ë¬´ë‹¨ìˆ˜ì§‘ ê±°ë¶€">ì´ë©”ì¼ ë¬´ë‹¨ìˆ˜ì§‘ ê±°ë¶€</span>
        <span class="footer-right">Copyright â“’ (ì£¼)ì—‘íƒ€ìŠ¤. All Rights Reserved.</span>
        <!--footer [E]-->
    </div>
</div>


<script type="text/javascript" src="/resource/jquery.min.js"></script>
<script type="text/javascript" src="/resource/jquery-validation/1.17.0/jquery.validate.min.js"></script>

<script type="text/javascript">
    $('html').attr('lang', sessionStorage.getItem('lang_code'));
</script>
<script type="text/javascript" src="/resource/windowContainer/js/jquery.scrollbar.min.js"></script>
<script type="text/javascript" src="/resource/windowContainer/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/resource/ax5ui/ax5ui.all.min.js?v=1000"></script>

<!-- ë©”ë‰´íƒ­ ì´ë™ script -->
<script type="text/javascript" src="/resource/windowContainer/js/html5sortable.js"></script>
<script type="text/javascript" src="/js/nth-tabs.js?v=1030"></script>

<th:block th:replace="system_js :: system_js"></th:block>

<script src="/js/common.js?v=1060"></script>
<!--<script type="text/javascript" src="/js/yumenu.js?v=1070"></script>-->
<!--<script type="text/javascript" src="/js/yuscript.js?v=1060"></script>-->
<script type="text/javascript" src="/js/ax5commUtil.js?v=1070"></script>
<script type="text/javascript">
    let nthTabs = null;
    let default_menu = null;
    let menuName_list = [];
    let menu_arr = [];

    $(document).ready(function () {


        $(".left").click(function () {
            nthTabs.delAllTab();
            // window.location.reload();
        });

        // let lang_cd = i18n.getLanguageCode();
        //i18n.initializeCommonData(lang_cd);
        // i18n.initializeMenuData(lang_cd);

        // ë©”ë‰´ ë§¤í•‘(FrontFolder_id)

        nthTabs = $('#main-tabs').nthTabs();

        //-------í˜ì´ì§€ ì´ë™
        //ì „ì—­ì— ê³µìœ  + ì¤€ë¹„ í”Œë˜ê·¸ ì„¸íŒ…
        window.nthTabs = nthTabs;
        window.__nthTabsReady = true;
        window.__nthOpenQueue = window.__nthOpenQueue || [];

        // ì¤€ë¹„ ì™„ë£Œ ì´ë²¤íŠ¸ (ì˜µì…˜)
        window.dispatchEvent(new Event('nthTabsReady'));

        //ëŒ€ê¸°ì—´ ì²˜ë¦¬ (ì´ˆê¸°í™” ì „ì— ì—´ë¦° ìš”ì²­ë“¤ ì‹¤í–‰)
        const queue = window.__nthOpenQueue.splice(0);
        queue.forEach(args => window.openTabInMain(args));

        //íƒ­ ì—´ê¸° í•¨ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©
        window.openTabInMain = function ({ id, title, url, isbookmark=false, allowClose=true }) {
            if (!id) return;
            url = url || ('/gui/' + id + '/default');

            if (!window.__nthTabsReady || !window.nthTabs || typeof window.nthTabs.addTab !== 'function') {
                window.__nthOpenQueue.push({ id, title, url, isbookmark, allowClose });
                return;
            }

            if (window.nthTabs.isExistsTab('#' + id)) {
                window.nthTabs.toggleTab('#' + id);
            } else {
                window.nthTabs.addTab({
                    id,
                    title: title || id,
                    url,
                    active: true,
                    allowClose,
                    isbookmark: isbookmark ? 'true' : 'false'
                });
            }
        };
        //------- í˜ì´ì§€ ì´ë™ ë
        // ==========================
        //  ê¸°ë³¸ìœ¼ë¡œ ì—´ë¦´ ë©”ë‰´ (ì›í•˜ëŠ” ê°’ìœ¼ë¡œ ìˆ˜ì •)
        // ==========================
        const DEFAULT_MENU = {
            // íƒ­ id: ì¤‘ë³µ ì•ˆ ë‚˜ê²Œë§Œ í•´ì£¼ë©´ ë¨ (staticMenusì— ìˆëŠ” id ì¨ë„ ë˜ê³ , ìƒˆë¡œ ì¨ë„ ë¨)
            id: 'dashboard_cms',
            // íƒ­ ì œëª©
            title: 'ëª¨ë‹ˆí„°ë§-ì‹¤ì‹œê°„í˜„í™©',
            // ì‹¤ì œë¡œ í˜¸ì¶œí•  URL
            url: '/dashboard'
        };

         // ==========================
        //  í•˜ë“œì½”ë”© ë©”ë‰´ ì •ì˜
        // ==========================
        const staticMenus = {
            // ê¸°ì¤€ì •ë³´  -> #dep2-monitoring
            monitoring: [
                { id: 'app01_index01', title: 'ê³µí†µì½”ë“œë“±ë¡', url: '/app01/index01' },
                { id: 'app01_index18', title: 'ì‚¬ì›ì½”ë“œë“±ë¡', url: '/app01/index18' },
                { id: 'app01_index07', title: 'ê±°ë˜ì²˜ë“±ë¡', url: '/app01/index07' },
                { id: 'app01_index05', title: 'KCCí’ˆëª©ë“±ë¡', url: '/app01/index05' },
                { id: 'app01_index16', title: 'ë§¤ì¶œí’ˆëª©ë“±ë¡', url: '/app01/index16' },
                { id: 'app01_index051', title: 'ì›ë¶€ìì¬ë“±ë¡', url: '/app01/index051' },
                { id: 'app01_index052', title: 'ì˜ˆë¹„ë¶€í’ˆë“±ë¡', url: '/app01/index052' },
                { id: 'app01_index06', title: 'ì†Œìš”ëŸ‰ë“±ë¡', url: '/app01/index06' },
                { id: 'app01_index02', title: 'ê³µì •ë³„ì„¤ë¹„', url: '/app01/index02' }
            ],

            // ê¸ˆí˜•ê´€ë¦¬ -> #dep2-information
            information: [
                { id: 'app01_index08',   title: 'ê¸ˆí˜•ë“±ë¡',        url: '/app01/index08' },
                { id: 'app01_indexds00', title: 'ì´ë ¥ê´€ë¦¬',        url: '/app01/indexds00' },
                { id: 'app01_indexds03', title: 'ê¸ˆí˜•í˜„í™©List',    url: '/app01/indexds03' },
                { id: 'app02_index19',   title: 'ì˜ˆë¹„ë¶€í’ˆê´€ë¦¬',    url: '/app02/index19' }
            ],

            // ìƒì‚°ê´€ë¦¬ -> #dep2-sales-management
            sales: [
                { id: 'app02_index10', title: 'ì£¼ê°„ìƒì‚°ê³„íšë“±ë¡',  url: '/app02/index10' },
                { id: 'app02_index15', title: 'ì›ìì¬ì…ì¶œê³ ë“±ë¡',  url: '/app02/index15' },
                { id: 'app01_index09', title: 'ì‚¬ì¶œê³µì •',          url: '/app01/index09' },
                { id: 'app02_index45', title: 'ì¡°ë¦½ê³µì •',          url: '/app02/index45' },
                { id: 'app02_index41', title: 'ê²€ì‚¬ê³µì •',          url: '/app02/index41' },
                { id: 'app02_index21', title: 'ì¶œí•˜ë“±ë¡',          url: '/app02/index21' },
                { id: 'app02_index00_ng_dispose', title: 'ë¶€ì í•©í’ˆíê¸°', url: '/app02/index00' }
            ],

            // ê³µì •ê´€ë¦¬ -> #dep2-purchase-materials
            process: [
                { id: 'app02_index53', title: 'ìƒì‚°í˜„í™©ì¡°íšŒ',   url: '/app02/index53' },
                { id: 'app02_index51', title: 'ì‘ì—…ì¼ì§€ì¡°íšŒ',   url: '/app02/index51' },
                { id: 'app02_index00_oee', title: 'ì„¤ë¹„ê°€ë™ìœ¨', url: '/app02/index00' },
                { id: 'app02_index52', title: 'ë¶ˆëŸ‰í˜„í™©ì¡°íšŒ',   url: '/app02/index52' },
                { id: 'app02_index00_unit', title: 'ì›ë‹¨ìœ„ê´€ë¦¬', url: '/app02/index00' }
            ],

            // ë‚©í’ˆê´€ë¦¬ -> #dep2-inventory-materials
            delivery: [
                { id: 'app01_index23', title: 'ë°œì£¼ë“±ë¡',        url: '/app01/index23' },
                { id: 'app02_index00_container', title: 'ë‚©ì…ìš©ê¸°ê´€ë¦¬', url: '/app02/index00' },
                { id: 'app02_index59', title: 'ê¸°ì´ˆì¬ê³ ',        url: '/app02/index59' },
                { id: 'app02_index60', title: 'ì œí’ˆë³„ì¬ê³ í˜„í™©',  url: '/app02/index60' },
                { id: 'app02_index63', title: 'ì œí’ˆìˆ˜ë¶ˆì›ì¥',    url: '/app02/index63' }
            ],

            // F/PROOF -> #dep2-production-management
            fproof: [
                { id: 'app01_index00_std1',     title: 'í‘œì¤€ë¥˜ê´€ë¦¬', url: '/app01/index00' },
                { id: 'app02_index00_std2',     title: 'í‘œì¤€ë¥˜ê´€ë¦¬', url: '/app02/index00' },
                { id: 'app02_index00_std3',     title: 'í‘œì¤€ë¥˜ê´€ë¦¬', url: '/app02/index00' },
                { id: 'app02_index00_mold_cond',   title: 'ì„±í˜•ì¡°ê±´ê¸°ì¤€',      url: '/app02/index00' },
                { id: 'app02_index00_mold_hist',   title: 'ì„±í˜•ì¡°ê±´ë³€ê²½ì´ë ¥',  url: '/app02/index00' },
                { id: 'app02_index00_alarm_hist',  title: 'ì•ŒëŒë°œìƒì´ë ¥',      url: '/app02/index00' },
                { id: 'app02_index63_mold_vs_eqp', title: 'ì„±í˜•ì¡°ê±´ê¸°ì¤€ / ì„¤ë¹„ì„±í˜•ì¡°ê±´ (ì¢Œìš°í‘œì‹œ)', url: '/app02/index63' },
                { id: 'dashboard_cms',     title: 'ëª¨ë‹ˆí„°ë§-ì‹¤ì‹œê°„í˜„í™©', url: '/dashboard' },
                { id: 'app01_indexds04',        title: 'ëª¨ë‹ˆí„°ë§-ìƒì‚°ê°€ë™í˜„í™©', url: '/app01/indexds04' }
            ],

            // í’ˆì§ˆê´€ë¦¬ -> #dep2-quality
            quality: [
                { id: 'app01_index00_qc1',  title: 'ì´ˆì¤‘ì¢…ë¬¼ê²€ì‚¬',      url: '/app01/index00' },
                { id: 'app02_index00_spc',  title: 'SPCê´€ë¦¬',           url: '/app02/index00' },
                { id: 'app02_index54',      title: 'ë¶ˆëŸ‰ì¶”ì´ë„ì¡°íšŒ',    url: '/app02/index54' },
                { id: 'app02_index00_4m',   title: '4Më³€ê²½',           url: '/app02/index00' },
                { id: 'app02_index00_reli', title: 'ì •ê¸°ì‹ ë¢°ì„±(ì—°ì†Œì„±)', url: '/app02/index00' }
            ],

            // ì„¤ë¹„ê´€ë¦¬ -> #dep2-transaction
            facility: [
                { id: 'app01_index22',      title: 'ì„¤ë¹„ì¹´ë“œë“±ë¡',  url: '/app01/index22' },
                { id: 'app02_index00_eqp',  title: 'ì„¤ë¹„ì¼ìƒì ê²€',  url: '/app02/index00' }
            ],

            // ì‹œìŠ¤í…œ ì„¤ì • -> #dep2-system-settings  (í•„ìš”í•˜ë©´ ë‚˜ì¤‘ì— ì¶”ê°€)
            system: [
                // ì˜ˆì‹œ:
                // { id: 'sys_user', title: 'ì‚¬ìš©ìê´€ë¦¬', url: '/system/user' }
            ]
        };

        // dep2 ì»¨í…Œì´ë„ˆ id ë§¤í•‘(HTML êµ¬ì¡°ì™€ ì—°ê²°)
        const staticDep2Targets = {
            monitoring:  { selector: '#dep2-monitoring',        groupTitle: 'ê¸°ì¤€ì •ë³´' },
            information: { selector: '#dep2-information',       groupTitle: 'ê¸ˆí˜•ê´€ë¦¬' },
            sales:       { selector: '#dep2-sales-management',  groupTitle: 'ìƒì‚°ê´€ë¦¬' },
            process:     { selector: '#dep2-purchase-materials',groupTitle: 'ê³µì •ê´€ë¦¬' },
            delivery:    { selector: '#dep2-inventory-materials',groupTitle: 'ë‚©í’ˆê´€ë¦¬' },
            fproof:      { selector: '#dep2-production-management',groupTitle: 'F/PROOF' },
            quality:     { selector: '#dep2-quality',           groupTitle: 'í’ˆì§ˆê´€ë¦¬' },
            facility:    { selector: '#dep2-transaction',       groupTitle: 'ì„¤ë¹„ê´€ë¦¬' },
            system:      { selector: '#dep2-system-settings',   groupTitle: 'ì‹œìŠ¤í…œì„¤ì •' }
        };

        // ==========================
        //  í•˜ë“œì½”ë”© ë©”ë‰´ DOM ìƒì„±
        // ==========================
        function buildStaticMenus() {

            function addGroup(targetSelector, items, groupTitle) {
                const $dep2 = $(targetSelector);
                if (!$dep2.length || !items || !items.length) return;

                // â˜… ëŒ€ë¶„ë¥˜ li.dep1-1 ì´ ê¸°ë³¸ì ìœ¼ë¡œ display:none ì´ë¼
                //   í•˜ë“œì½”ë”© ë©”ë‰´ì—ì„œë„ ë°˜ë“œì‹œ ë³´ì—¬ì£¼ë„ë¡ ì²˜ë¦¬
                $dep2.closest('.dep1-1').css('display', 'block');

                // dep2-1 í•˜ë‚˜ ë§Œë“¤ê³  ì•ˆì— dep3(ì‹¤ì œ ë©”ë‰´ë“¤) ë„£ëŠ” êµ¬ì¡°
                const $li    = $('<li class="dep2-1"></li>');
                const $a     = $('<a href="#"></a>').text(groupTitle || '');
                const $subUl = $('<ul class="dep3 documents"></ul>'); // styleì€ CSSì— ë§¡ê¹€

                items.forEach(item => {
                    const $itemLi = $('<li class="dep3-custom-list-style"></li>');
                    const $itemA  = $('<a href="#"></a>')
                        .text(item.title)
                        .attr('data-id', item.id)
                        .attr('data-url', item.url)
                        .attr('title', item.title);

                    $itemLi.append($itemA);
                    $subUl.append($itemLi);
                });

                $li.append($a).append($subUl);
                $dep2.append($li);
            }

            // ì‹¤ì œë¡œ ê° ì„¹ì…˜ì— ì±„ì›Œ ë„£ê¸°
            Object.keys(staticDep2Targets).forEach(key => {
                const cfg = staticDep2Targets[key];
                addGroup(cfg.selector, staticMenus[key], cfg.groupTitle);
            });
        }

        // DOM ì¤€ë¹„ í›„ í•œ ë²ˆ í˜¸ì¶œí•´ì„œ ë©”ë‰´ ê·¸ë¦¬ê¸°
        buildStaticMenus();


        // ==========================
        //  í•˜ë“œì½”ë”© ë©”ë‰´ í´ë¦­ ì´ë²¤íŠ¸
        // ==========================
        // dep3(ì‹¤ì œ ë©”ë‰´) a í´ë¦­ ì‹œ íƒ­ ì—´ê¸°
        $(document).on('click', '.dep3 a[data-id]', function (e) {
            e.preventDefault();

            // ì„ íƒ í‘œì‹œ(ì„ íƒ ìŠ¤íƒ€ì¼ ìœ ì§€í•˜ë ¤ë©´ ê¸°ì¡´ í´ë˜ìŠ¤ ì‚¬ìš©)
            $('.dep3 li').removeClass('on');
            const $li = $(this).parent('li');
            $li.addClass('on');

            const id    = $(this).data('id');
            const url   = $(this).data('url');
            const title = $(this).attr('title') || $(this).text();

            if (!id || !url) return;

            // nthTabsë¥¼ í†µí•´ íƒ­ ì—´ê¸° (ì´ë¯¸ ì—´ë ¤ ìˆìœ¼ë©´ í† ê¸€)
            if (nthTabs.isExistsTab('#' + id)) {
                nthTabs.toggleTab('#' + id);
            } else {
                nthTabs.addTab({
                    id: id,
                    title: title,
                    url: url,          // ì—¬ê¸°ì„œ /gui/... ëŒ€ì‹  ìš°ë¦¬ê°€ ë„£ì€ URL ê·¸ëŒ€ë¡œ ì‚¬ìš©
                    active: true,
                    allowClose: true
                });
            }

            // í™”ë©´ì´ ì¢ì„ ë•Œ ë©”ë‰´ ìë™ ë‹«ê³  ì‹¶ìœ¼ë©´ ì•„ë˜ ì£¼ì„ í•´ì œí•´ì„œ ì‚¬ìš©
            /*
            const winWidth = $(window).width();
            if (winWidth <= 1366) {
                $('.menu_area').addClass('hidden');
                $('#navbarBarMenu2 .open_menu').removeClass('menu_open');
                $('.con_area, .tab-content').css({
                    'width': '100%',
                    'left': '0'
                });
            }
            */
        });


        $(function () {
            let userToggled = false;  // ì‚¬ìš©ìê°€ ì§ì ‘ í† ê¸€í–ˆëŠ”ì§€ ì—¬ë¶€
            let autoHiddenOnce = false; // 1366 ì´ìƒì¼ ë•Œ ìë™ ìˆ¨ê¹€ì„ í•œ ë²ˆë§Œ ì‹¤í–‰í•˜ë„ë¡

            function adjustMenu() {
                const winWidth = $(window).width();

                if (!userToggled) {
                    if (winWidth <= 1366) {
                        // ì‘ì€ í™”ë©´: í•­ìƒ ë©”ë‰´ ìˆ¨ê¹€
                        $('.menu_area').addClass('hidden');
                        $('.con_area, .tab-content').css({
                            'width': '100%',
                            'left': '0'
                        });
                    } else {
                        // í° í™”ë©´(1366 ì´ˆê³¼): í•œ ë²ˆë§Œ ìë™ ìˆ¨ê¹€
                        if (!autoHiddenOnce) {
                            $('.menu_area').addClass('hidden');
                            $('.con_area, .tab-content').css({
                                'width': '100%',
                                'left': '0'
                            });
                            autoHiddenOnce = true; // í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ë„ë¡ í”Œë˜ê·¸ ì„¤ì •
                        }
                    }
                }
            }

            // í˜ì´ì§€ ë¡œë“œ ë° ë¦¬ì‚¬ì´ì¦ˆ ì‹œ ì ìš©
            $(window).on('load resize', adjustMenu);

            // ë©”ë‰´ í† ê¸€ ë²„íŠ¼ í´ë¦­ ì‹œ
            $('#navbarBarMenu2 .open_menu').click(function () {
                userToggled = true; // ì‚¬ìš©ìê°€ ì§ì ‘ ì¡°ì‘í–ˆìœ¼ë¯€ë¡œ ìë™ëª¨ë“œ í•´ì œ

                $(this).toggleClass('menu_open');
                $('.menu_area').toggleClass('hidden');

                const isMenuHidden = $('.menu_area').hasClass('hidden');
                $('.con_area, .tab-content').css({
                    'width': isMenuHidden ? '100%' : 'calc(100% - 250px)',
                    'left': isMenuHidden ? '0' : '250px'
                });
            });
        });

         // ==========================
        //  ë¶ë§ˆí¬ ë° default_menu ì²˜ë¦¬
        //   - bookmark ì—†ìœ¼ë©´ ì¡°ìš©íˆ ë¬´ì‹œ
        //   - default_menu ëŠ” í•­ìƒ ë¡œë”©
        // ==========================

        // ==========================
        //  default ë©”ë‰´ ì—´ê¸° (ì„œë²„ í˜¸ì¶œ X)
        // ==========================
        function openDefaultMenu() {
            if (!DEFAULT_MENU || !DEFAULT_MENU.id) {
                console.warn('DEFAULT_MENUê°€ ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.');
                return;
            }

            // ì´ë¯¸ ì—´ë ¤ ìˆìœ¼ë©´ í† ê¸€ë§Œ
            if (nthTabs.isExistsTab('#' + DEFAULT_MENU.id)) {
                nthTabs.toggleTab('#' + DEFAULT_MENU.id);
            } else {
                nthTabs.addTab({
                    id: DEFAULT_MENU.id,
                    title: DEFAULT_MENU.title,
                    url: DEFAULT_MENU.url,   // í•˜ë“œì½”ë”© URL ì§ì ‘ ì‚¬ìš©
                    active: true,
                    allowClose: false
                });
            }
        }

        // bookmark ë¡œë”© (ì—†ìœ¼ë©´ ê·¸ëƒ¥ ê±´ë„ˆëœ€)



        // ë¶ë§ˆí¬/í—¤ë” ë²„íŠ¼ í´ë¦­ ì‹œ íƒ­ ì—´ê¸°
        $(document).on('click', '#bookmark-menu a, .header-menu .menu-btn', function (e) {
            e.preventDefault();
            $('#bookmark-menu li').removeClass('on');
            $(this).parent('li').addClass('on');

            var val = $(this).text();
            var menuurl = $(this).attr('menuurl');
            var objid = $(this).attr('data-objid');
            var _bookmark = 'true';

            if (nthTabs.isExistsTab('#' + objid)) {
                nthTabs.toggleTab('#' + objid);
            } else {
                nthTabs.addTab({
                    id: objid,
                    title: val,
                    url: '/gui/' + objid + '/default',
                    active: true,
                    allowClose: true,
                    isbookmark: _bookmark
                });
            }
        });

        // ğŸ”¹ ë“œë˜ê·¸ ì •ë ¬
        const headerMenu = document.querySelector('.header-menu');
        if (headerMenu) {
            let draggedBtn = null;

            headerMenu.addEventListener('dragstart', (e) => {
                if (e.target.classList.contains('menu-btn')) {
                    draggedBtn = e.target;
                    e.target.classList.add('dragging');
                }
            });

            headerMenu.addEventListener('dragend', (e) => {
                if (draggedBtn) {
                    draggedBtn.classList.remove('dragging');
                    draggedBtn = null;
                    saveBookmarkOrder(); // ë“œë˜ê·¸ ëë‚˜ë©´ ìˆœì„œ ì €ì¥
                }
            });

            headerMenu.addEventListener('dragover', (e) => {
                e.preventDefault();
                const afterElement = getDragAfterElement(headerMenu, e.clientX);
                const dragging = document.querySelector('.dragging');
                if (!dragging) return;

                if (afterElement == null) {
                    headerMenu.appendChild(dragging);
                } else {
                    headerMenu.insertBefore(dragging, afterElement);
                }
            });

            function getDragAfterElement(container, x) {
                const draggableElements = [...container.querySelectorAll('.menu-btn:not(.dragging)')];
                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offset = x - box.left - box.width / 2;
                    if (offset < 0 && offset > closest.offset) {
                        return { offset: offset, element: child };
                    } else {
                        return closest;
                    }
                }, { offset: Number.NEGATIVE_INFINITY }).element;
            }

            // ğŸ”¹ ìˆœì„œ ì €ì¥ AJAX
            function saveBookmarkOrder() {
                const buttons = document.querySelectorAll('.header-menu .menu-btn');
                const newOrder = [];
                buttons.forEach((btn, index) => {
                    newOrder.push({
                        menucode: btn.getAttribute('data-objid'),
                        order: index + 1
                    });
                });

                const csrfInput = document.querySelector('[name=_csrf]');
                if (!csrfInput) {
                    console.warn('CSRF í† í°ì´ ì—†ì–´ ë¶ë§ˆí¬ ìˆœì„œë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    return;
                }

                let csrf = csrfInput.value;

                $.ajax({
                    url: '/api/system/bookmark/reorder',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify(newOrder),
                    headers: { 'X-CSRF-TOKEN': csrf },
                    success: function (res) {
                        if (res.success) {
                            console.log('ë¶ë§ˆí¬ ìˆœì„œ ì €ì¥ ì™„ë£Œ');
                        } else {
                            console.error('ë¶ë§ˆí¬ ìˆœì„œ ì €ì¥ ì‹¤íŒ¨');
                        }
                    },
                    error: function () {
                        console.error('ì„œë²„ í†µì‹  ì¤‘ ì˜¤ë¥˜ ë°œìƒ');
                    }
                });
            }
        }

        // âœ… bookmark ì„±ê³µ/ì‹¤íŒ¨ì™€ ê´€ê³„ì—†ì´ default ë©”ë‰´ëŠ” í•­ìƒ ë¡œë”©
        openDefaultMenu();

        $('.scrollbar-inner').scrollbar();

        // TABë©”ë‰´ Context Menu
        $('#tabdragdrop').on('contextmenu', 'li', function (e) {
            if ($(this).attr('not-allow-close') === undefined) {
                $('.otherAuthmaintab').show();
                if ($(this).hasClass('active')) {
                    $('.otherAuthtab').show();
                } else {
                    $('.otherAuthtab').hide();
                }
            } else {
                $('.otherAuthmaintab').hide();
            }
            var leftxpo = 260;
            if ($('.menu_close .menu_area').css('left') !== undefined) {
                leftxpo = 15;
            }
            var left = e.pageX - leftxpo;
            $('#contextTabMenu').toggle().css({
                left: left + 'px'
            }).attr('targetObjId', $(this).children('a').attr('href'));
            return false;
        });

        $(".profile_box").click(function () {
            $(".profile_mbox").toggle();
        })

        $(".btn_nbox_close").click(function () {
            $(".notification_mbox").hide();
        });

        $(".btn_pbox_close").click(function () {
            $(".profile_mbox").hide();
        });


        $('#logout').on('click', function (e) {
            e.preventDefault();
            Alert.confirm('', 'ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?', function () {
                i18n.resetData();
                location.href = '/logout';
            });
        });


        // // ë‚´ì •ë³´ í´ë¦­
        $('#myinfo').on('click', function (e) {
            e.preventDefault();
            Ax5Modal.open({url: '/page/account/myinfo', width: 400, height: 380});
            $(".profile_contbox").hide();
        });
        // ì˜¤í”ˆì†ŒìŠ¤ ì‚¬ìš©ê³µì§€ í•„ìš”


    //ë©”ë‰´ ê²€ìƒ‰ì°½ ì´ë²¤íŠ¸ ë“±ë¡
    // document.addEventListener('input', function(event){
    //     if(event.target){
    //         const ele = event.target;
    //
    //         if(ele.id === 'searchkeyword'){
    //             initializeAutocomplete('searchkeyword', 'searchkeyword-box', menuName_list, menu_arr)
    //         }
    //     }
    // });

    //ë©”ë‰´ ê²€ìƒ‰ë°” ì—”í„°ì‹œ ë°œë™í•¨ìˆ˜
    // document.getElementById('searchkeyword').addEventListener("keydown", (e) => {
    //     if(e.key === 'Enter'){
    //         e.preventDefault();
    //
    //         const inputValue = $('#searchkeyword').val();
    //
    //         const matchedItem = menu_arr.find(obj => {
    //             const key = Object.keys(obj)[0];
    //             return key.trim() === inputValue;
    //         })
    //
    //         if(matchedItem) {
    //             const url = matchedItem[inputValue];
    //             const target = url.substring(url.lastIndexOf("/")+1);
    //             document.querySelector(`[data-objid="${target}"]`)?.click();
    //         }
    //     }
    // });

});     // â˜… ì¶”ê°€: $(document).ready(...) ë‹«ê¸°
</script>

<script type="text/javascript">
    // ë‚ ì”¨ ì •ë³´
    // fetchWeatherData();
    // 30ë¶„ë§ˆë‹¤ ë‚ ì”¨ ì •ë³´ ìë™ ê°±ì‹ 
    setInterval(fetchWeatherData, 1800000);

    function sseConnect(){

        const spjangcd = sessionStorage.getItem("spjangcd");

        const eventSource = new EventSource("/sse/subscribe?spjangcd="  + spjangcd);

        eventSource.onmessage = function (e){

            if(e.data){
                Notify.success(e.data);

            }

        }

        eventSource.onerror = function(err) {
            console.log('SSE ì˜¤ë¥˜ ë°œìƒ, ì¬ì—°ê²° ì‹œë„ ì¤‘...', err);
            eventSource.close();
            setTimeout(sseConnect, 3000);
        };
    }
    //sseConnect();

    // ë‚ ì”¨ ì •ë³´ë¥¼ ì„œë²„ì—ì„œ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
    function fetchWeatherData() {
        $.ajax({
            url: '/weather/current',
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                // JSON ë°ì´í„° êµ¬ì¡°ë¥¼ ì´ìš©í•˜ì—¬ ê° í•­ëª©ì— ëŒ€í•œ ê°’ì„ ì¶”ì¶œ
                //console.log(data); // ë°˜í™˜ëœ ë°ì´í„°ë¥¼ ì½˜ì†”ì— ì¶œë ¥
                const fullAddress = data.address;
                const shortAddress = fullAddress.split(" ")[0] + " " + fullAddress.split(" ")[1] + " " + fullAddress.split(" ")[2];
                $('#area').text(shortAddress); // ì§€ì—­ ì •ë³´ í‘œì‹œ
                $('#temperature').html(`${data.T1H}<span class="celsius">â„ƒ</span>`);
                $('#precipitationProbability').html(data.POP ? `${data.POP}%` : '0%'); // ê°•ìˆ˜í™•ë¥ ì´ ì—†ëŠ” ê²½ìš° '0%'ë¡œ í‘œì‹œ
                $('#humidity').html(`${data.REH}%`); // ìŠµë„ë¥¼ í‘œì‹œí•  ë•Œ '%'ë¥¼ ì¶”ê°€
                $('#windSpeed').html(`${data.WSD}m/s`); // í’ì†ì„ í‘œì‹œí•  ë•Œ 'm/s'ë¥¼ ì¶”ê°€

                // ë‚ ì”¨ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
                updateWeatherIcon(data.SKY, data.PTY);

                const now = new Date();
                const formatted = now.getHours().toString().padStart(2, '0') + ':' +
                    now.getMinutes().toString().padStart(2, '0');
                $('#lastUpdated').text(`ì—…ë°ì´íŠ¸: ${formatted}`);
            },
            error: function (error) {
                console.error('Error fetching weather data:', error);
            }
        });
    }

    // ë‚ ì”¨ ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateWeatherIcon(skyValue, ptyValue) {
        // console.log("PTY Value:", ptyValue);
        // console.log("SKY Value:", skyValue);

        let iconPath = '/images/icon/weather/';
        let altText = 'ë‚ ì”¨ ì•„ì´ì½˜';

        // PTY ê°’ì— ë”°ë¼ ë¨¼ì € íŒë‹¨ (ê°•ìˆ˜ í˜•íƒœ ìš°ì„ )
        if (ptyValue == '1') {
            iconPath += 'ico-wt4.svg'; // ë¹„
            altText = 'ë¹„';
        } else if (ptyValue == '3') {
            iconPath += 'ico-wt5.svg'; // ëˆˆ
            altText = 'ëˆˆ';
        } else if (ptyValue == '4') {
            iconPath += 'ico-wt7.svg'; // ì†Œë‚˜ê¸°
            altText = 'ì†Œë‚˜ê¸°';
        } else {
            // PTY ê°’ì´ 0ì´ê±°ë‚˜ ë¹„ì–´ ìˆì„ ë•ŒëŠ” SKY ê°’ìœ¼ë¡œ íŒë‹¨
            if (skyValue == '1') {
                iconPath += 'ico-wt1.svg'; // ë§‘ìŒ
                altText = 'ë§‘ìŒ';
            } else if (skyValue == '2') {
                iconPath += 'ico-wt2.svg'; // êµ¬ë¦„ ì¡°ê¸ˆ
                altText = 'êµ¬ë¦„ ì¡°ê¸ˆ';
            } else if (skyValue == '3' || skyValue == '4') {
                iconPath += 'ico-wt3.svg'; // êµ¬ë¦„ ë§ìŒ ë˜ëŠ” íë¦¼
                altText = 'êµ¬ë¦„ ë§ìŒ ë˜ëŠ” íë¦¼';
            }
        }

        // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸
        const weatherIcon = $('#weatherIcon');
        weatherIcon.attr('src', iconPath);
        weatherIcon.attr('alt', altText);

    }


</script>


<script>
    const myFactoryId = '';
    const myGroupId = '';
</script>


<!--ì›¹ì†Œì¼“-->
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

<script>
    let stompClient = null;
    let reconnectTimeout = null;
    let heartbeatInterval = null;
    let reconnectAttempts = 0;
    let isConnecting = false;

    // âœ… ë©”ì¸ WebSocket ì—°ê²° í•¨ìˆ˜
    function connectWS() {
        if (isConnecting || (stompClient && stompClient.connected)) return;
        isConnecting = true;

        const socket = new SockJS('/ws');
        stompClient = Stomp.over(socket);
        stompClient.debug = null; // ë¡œê·¸ ìµœì†Œí™”

        stompClient.connect({}, function () {
            reconnectAttempts = 0;
            isConnecting = false;

            // êµ¬ë…
            stompClient.subscribe('/topic/joborder', function (message) {
                handleJobOrderMessage(JSON.parse(message.body));
            });

            // ping ìœ ì§€
            clearInterval(heartbeatInterval);
            heartbeatInterval = setInterval(() => {
                try {
                    if (stompClient.connected)
                        stompClient.send('/app/hello', {}, 'ping');
                } catch (_) { }
            }, 30000);
        }, function () {
            isConnecting = false;
            handleDisconnect();
        });
    }


    // âœ… ì—°ê²° ëŠê¹€ ì²˜ë¦¬ ë° ì¬ì—°ê²°
    function handleDisconnect() {
        clearInterval(heartbeatInterval);
        heartbeatInterval = null;
        clearTimeout(reconnectTimeout);

        reconnectAttempts++;
        const delay = reconnectAttempts === 1 ? 1000 : Math.min(10000, 1000 * reconnectAttempts);
        reconnectTimeout = setTimeout(connectWS, delay);
    }

    // âœ… í™”ë©´ ë³µê·€ ì‹œ ìë™ ì¬ì—°ê²°
    document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible' && (!stompClient || !stompClient.connected)) {
            connectWS();
        }
    });

    // âœ… ì£¼ê¸°ì  ìƒíƒœ ì ê²€ (5ë¶„ ì£¼ê¸°)
    setInterval(() => {
        if (!stompClient || !stompClient.connected) connectWS();
    }, 300000);

    // âœ… í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì—°ê²°
    //window.addEventListener('load', connectWS);

    // âœ… ì¢…ë£Œ ì‹œ ì •ë¦¬
    window.addEventListener('beforeunload', () => {
        try {
            if (stompClient && stompClient.connected) stompClient.disconnect();
        } catch (_) { }
        clearInterval(heartbeatInterval);
        clearTimeout(reconnectTimeout);
    });
</script>

<!--<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>-->
<style>
    .select-no-border {
        font-size: 14px;
        width: 110px;
        max-width: 110px;
        padding: 0 10px;
        border: none;
        outline: none;
        background-color: transparent;
        appearance: none;
        border-bottom: 1px solid;
        border-radius: 0;
        -webkit-appearance: none;
        -moz-appearance: none;
    }

    /* í¬ì»¤ìŠ¤ ì‹œ ì€ì€í•œ íšŒìƒ‰ í…Œë‘ë¦¬ */
    .select-no-border:focus {
        border: 1px solid #ccc;
        border-radius: 4px;
        outline: none;
        box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.08);
    }

    #loader2 {
        position: fixed;
        top: 0;
        left: 0;
        background-color: #f0f0f0;
        opacity: 0.8;
        width: 100%;
        height: 100%;
        display: none; /* ì²˜ìŒì—ëŠ” ìˆ¨ê¹€ ìƒíƒœ */
        z-index: 999999;
    }

    #loader2 .loader {
        position: fixed;
        top: calc(50% - 48px);
        left: calc(50% - 48px);
        width: 96px;
        height: 96px;
        border-radius: 12px;
        background-color: rgba(0, 0, 0, 0.5);
    }

    #loader2 .loader > span {
        position: fixed;
        top: calc(50% - 27px);
        left: calc(50% - 27px);
        width: 48px;
        height: 48px;
        border: 3px solid #FFF;
        border-radius: 50%;
        display: inline-block;
        animation: rotation 1s linear infinite;
    }

    #loader2 .loader > span::after {
        content: '';
        box-sizing: border-box;
        position: absolute;
        left: 0;
        top: 0;
        background: #5ddfde;
        width: 16px;
        height: 16px;
        transform: translate(-50%, 50%);
        border-radius: 50%;
    }

    @keyframes rotation {
        0% {
            transform: rotate(0deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
</style>
<div id="loader2">
    <div class="loader">
        <span></span>
    </div>
</div>
</body>
</html>
